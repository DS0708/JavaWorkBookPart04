# 4.1 의존성 주입과 스프링

스프링 프레임워크가 가장 많이 사용되는 곳은 웹 개발 프로젝트지만, 스프링 프레임워크의 출발점은 객체지향이나 설계와
관련된 내용들이 주를 이루고 있다. 이번 절에서는 스프링을 이해하기 위한 핵심적인 내용으로 
`의존성 주입(dependency injection)`을 학습할 것이다.

## `스프링의 시작`

- 스프링 프레임워크는 원래 웹이라는 제한적인 용도로만 쓰이는 것이 아닌 객체지향의 `의존성 주입(dependency injection)`
기법을 적용할 수 있는 객체지향 프레임워크다.
- 로드 존슨이 2002년도에 집필했던 'J2EE 설계 및 개발(wrox)'이라는 책의 예제 코드에서 시작되었는데 말 그대로 효과적이고
가볍게 J2EE를 이용할 수 있다는 것을 증명하면서 예제의 코드들을 발전시킨 것이 스프링 프레임워크다.
- 2000년 당시 자바 진영에서 JavaEE의 여러 가지 스펙을 정의하고 비대해지는 동안 스프링 프레임워크는 
반대로 `light weight 프레임워크`를 목표로 만들어졌다.
- 그 당시 자바 진영에서는 EJB라는 기술을 기업용 애플리케이션 개발에 사용하기를 권장했지만 어마어마한 비용과 복잡함으로 인해
많은 비판이 있었다.
- 스프링 등장 시에 여러 종류의 프레임워크들이 비슷한 사상으로 등장했지만 다른 프레임워크들과 달리 스프링 프레임워크는 개발과
설계 전반에 관련된 문제들을 같이 다루었기 때문에 결론적으로 가장 성공한 프레임워크로 기록되었다.
- 스프링 프레임워크는 가장 중요한 '코어(core)' 역할을 하는 라이브러리와 여러 개의 추가적인 라이브러리를 결합하는 형태로
프로젝트를 구성한다.
- 가장 대표적으로 웹 MVC 구현을 쉽게 할 수 있는 `Spring Web MVC`나 JDBC를 쉽게 처리할 수 있는 
`MyBatis`를 연동하는 `mybatis-spring`과 같은 라이브러리가 그러한 예이다.


### 의존성 주입
- 스프링이 객체지향 구조를 설계할 때 받아들인 개념은 '의존성 주입'이며 '의존성 주입'은 어떻게 하면 '객체와 객체 간의
관계를 더 유연하게 유지할 것인가?'에 대한 고민으로 객체의 생성과 관계를 효과적으로 분리할 수 있는 방법에 대한 고민이다.
- 예를 들어 모든 컨트롤러들은 TodoService와 같은 서비스 객체를 이용해야만 하고 이 경우를 `컨트롤러는 서비스 객체에 의존적(dependent)`
라고 표현한다.
- 즉 `의존성이란` 하나의 객체가 자신이 해야 하는 일을 하기 위해서 다른 객체의 도움이 필수적인 관계를 의미한다.
- 과거에는 의존성을 해결하기 위해 컨트롤러에서 직접 서비스 객체를 생성하거나 앞의 예제들과 같이 하나의 객체만을 생성해 활용
하는 등의 다양한 패턴을 설계해서 적용해 왔지만 스프링 프레임워크는 바로 이런 점을 프레임워크 자체에서 지원하고 있다.
- 스프링 프레임워크는 다양한 방식으로 필요한 객체를 찾아서 사용할 수 있도록 XML 설정이나 자바 설정 등을 이용할 수 있으며
여기서는 XML설정을 이용하고, 뒤쪽의 스프링 부트편에서는 자바 설정을 이용할 것이다.


### 프로젝트 생성
- 'springex'라는 이름의 프로젝트를 생성한다.
- 프로젝트는 'Web application'으로 지정한다.
- Java와 Gradle을 이용하고 Group은 'org.zerock'을 지정한다.
- Java EE 8 버전 이용 설정을 한다.
- 프로젝트 생성 후 톰캣 관련 설정 조정
  - 상단 톰캣 부분에서 'Edig Configurations...' 클릭
  - [deployment] 설정 변경, 'war(exploaded)'로 지정하고 경로를 '/'로 조정
  - [Server] 탭에서는 On 'update' action와 On frame deactivation을 "Update classes and resources"로 변경


### 스프링 라이브러리 추가
- 프로젝트 생성 후에는 기본적으로 스프링을 구동하는 데 필요한 라이브러리들을 추가해줘야 한다.
- 스프링 프레임워크는 추가하는 jar파일에 따라 사용할 수 있는 기능들이 달라진다.
- 프레임워크 관련 라이브러리 버전은 구글을 이용해 [메이븐 저장소](https://mvnrepository.com/)에서 찾을 수 있다.
- build.gradle에 spring, Lombok, Log4j2, JSTL 라이브러리를 추가해보겠다.
  ```groovy
  dependencies {
    compileOnly('javax.servlet:javax.servlet-api:4.0.1')
  
    testImplementation("org.junit.jupiter:junit-jupiter-api:${junitVersion}")
    testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine:${junitVersion}")
  
    //Spring
    implementation group: 'org.springframework', name: 'spring-core', version: '5.3.19'
    implementation group: 'org.springframework', name: 'spring-context', version: '5.3.19'
    implementation group: 'org.springframework', name: 'spring-test', version: '5.3.19'
  
    //Lombok
    compileOnly group: 'org.projectlombok', name: 'lombok', version: '1.18.24'
    annotationProcessor 'org.projectlombok:lombok:1.18.24'
    testCompileOnly 'org.projectlombok:lombok:1.18.24'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.24'
  
    //Log4j2
    implementation group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.17.2'
    implementation group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.17.2'
    implementation group: 'org.apache.logging.log4j', name: 'log4j-slf4j-impl', version: '2.17.2'
  
    //JSTL
    implementation group: 'jstl', name: 'jstl', version: '1.2'
  }
  ```


### 실습01 - 의존성 주입하기
